{% extends "exercise_base.html" %}

{% block title %}{{ block.super }}XSS via URL Path Variables{% endblock %}

{% block header %}
    <h1>XSS via URL Path Variables</h1>
{% endblock %}

{% block extra_head %}
<script type="text/javascript">
window.onload = function() {
    var myvar = "{{path|safe}}";

    var result = '';
    if (document.title == 'PLZ HACK MY USERS') {
        result = '<div class="answer panel"><p><b>Success</b> You have managed to inject your ' +
            'own JavaScript into this page</p></div>';
    } else {
        result = 'This page has not yet been hacked.';
    }
    document.getElementById("result").innerHTML = result;
}
</script>
{% endblock %}

{% block content %}
<p>Many URL dispatching schemes give you the ability to pull data from
the path and have it passed into your controller. This allows you to set up
URLs like <code>/category/{id}</code> and that you want it to parse the id
and pass it into the view. Since the path is provided by the user we must
make sure it doesn't contain anything malicious.</p>

<p>In this exercise, manipulate the URL path to inject
JavaScript that will change this page title to <code>PLZ HACK MY USERS</code>.</p>

<div id="result"></div>

<div class="hints panel">
    <p>Helpful hints:</p>
    <ul>
        <li>Look at the HTML and compare it to the browser path.</li>
        <li><code>document.title</code> is the property that you want to modify.</li>
    </ul>
</div>
{% if path != "your-path-here" %}
    <a class="tiny button" id="show_solution">show solution</a>
{% endif %}
<div class="solution panel">
    <h4>Solution</h4>
    <p>The correct URL looks like:</p>
    <p><a href="/cross-site-scripting/path-matching/&quot;;document.title=&quot;PLZ%20HACK%20MY%20USERS&quot;;&quot;">/cross-site-scripting/path-matching/";document.title="PLZ%20HACK%20MY%20USERS";"</a>
    </div>
{% endblock %}

{% block extra_topnav %}
<li><a href="{% url 'xss' %}">Prev</a></li>
<li><a href="{% url 'xss-query' %}?qs=awesome">Next</a></li>
{% endblock %}

{% block extra_botnav %}
<li><a href="{% url 'xss' %}">Prev</a></li>
<li><a href="{% url 'xss-query' %}?qs=awesome">Next</a></li>
{% endblock %}
